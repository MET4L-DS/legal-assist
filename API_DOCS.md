# Legal RAG Engine - API Documentation

This document describes the API endpoints provided by the Legal RAG backend for frontend integration.

## Base URL

The default base URL for the local development server is:
`http://localhost:8000`

---

## 1. Health Check

Check the status of the backend and its components.

- **URL**: `/health`
- **Method**: `GET`
- **Auth Required**: No

### Response (200 OK)

```json
{
	"status": "ok",
	"components": {
		"vector_store": "ready",
		"llm": "ready"
	}
}
```

---

## 2. Legal Query

The primary endpoint for asking legal questions. It performs intent classification, retrieval, and structured response generation.

- **URL**: `/api/v1/query`
- **Method**: `POST`
- **Auth Required**: No
- **Content-Type**: `application/json`

### Request Body

| Field    | Type      | Required | Description                                                     |
| :------- | :-------- | :------- | :-------------------------------------------------------------- |
| `query`  | `string`  | Yes      | The legal question asked by the user.                           |
| `stream` | `boolean` | No       | Whether to stream the response (currently defaults to `false`). |

**Example Request:**

```json
{
	"query": "What is the procedure for zero FIR?",
	"stream": false
}
```

### Response (200 OK)

Returns a structured legal response containing the answer, basis, and citations.

| Field             | Type            | Description                                                             |
| :---------------- | :-------------- | :---------------------------------------------------------------------- |
| `answer`          | `string`        | The natural language answer generated by the LLM.                       |
| `legal_basis`     | `string`        | A brief summary of the laws/sections that form the basis of the answer. |
| `procedure_steps` | `array[string]` | A list of chronological steps if the query was procedural.              |
| `important_notes` | `array[string]` | Caveats, exceptions, or important warnings relative to the law.         |
| `sources`         | `array[object]` | Detailed information about the source chunks used for the answer.       |
| `metadata`        | `object`        | Metadata about the query processing (intent, confidence, etc.).         |

**Source Object Fields:**

- `law`: Name of the Act or source document.
- `section`: Section or Clause number.
- `citation`: Full canonical citation (e.g., BNSS Section 173).
- `text`: The raw snippet of text from the document.

**Example Response:**

```json
{
	"answer": "A Zero FIR can be registered for cognizable offences in any police station...",
	"legal_basis": "Based on General SOP and BNSS Section 173.",
	"procedure_steps": [
		"Information is given to the officer in charge.",
		"Details are recorded in the General Diary.",
		"The report is transferred to the jurisdictional police station."
	],
	"important_notes": [
		"If received electronically, it must be signed within three days."
	],
	"sources": [
		{
			"law": "General SOP",
			"section": "Zero FIR",
			"citation": "General SOP - Eligibility to Register a Zero FIR",
			"text": "..."
		}
	],
	"metadata": {
		"category": "procedure",
		"confidence": 0.95
	}
}
```

### Errors

| Status Code | Description                                              |
| :---------- | :------------------------------------------------------- |
| 422         | Unprocessable Entity (Invalid request JSON).             |
| 503         | Service Unavailable (Legal Engine not initialized).      |
| 500         | Internal Server Error (LLM failure or processing error). |

---

## Development Notes

- **CORS**: Enabled for all origins (`*`) by default for local development.
- **Port**: Defaults to `8000`, configurable via `PORT` environment variable.
- **Logs**: Check `server_debug.log` for detailed request/response traces.
